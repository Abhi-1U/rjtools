---
title: "Create an article using `rjtools`"
author: H. Sherry Zhang
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{create_article}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  message = FALSE,
  comment = "#>"
)
```

```{r setup}
library(rjtools)
```

R journal features an automated online review process that requires certain structure and format on the submitted articles. To help authors meet these requirements, we create the `rjtools` package, with an intention that it would help R authors to write an R journal article, just as how `devtools` would help developers build a package. 

In this vignette, we will walk together through how to use `rjtools` to create an R journal article using the build-in template and how to perform checks required by the R journal.

# Create 

The package contains a template for the R journal articles, [how it differs from the template in `rticles`]. The `create_article()` function will create a paper folder in the root directory with three files: 

  - article.bib, 
  - article.Rmd, and 
  - RJwrapper.tex

The folder name and bib/Rmd file name can be changed with argument `dir_path` and `file_name`. Notice that the R journal requires the .bib file and the .Rmd file to have the same name ("article" as created by default) and we recommend connecting the surname of all the authors as a name. 

For example, an article by Di Cook, Catherine Hurley, Simon Urbanek, and Michael Kane can be created by

```{r eval = FALSE}
create_article(file_name = "cook-hurley-urbanek-kane")
```


This will generate 
  
  - cook-hurley-urbanek-kane.bib, 
  - cook-hurley-urbanek-kane.Rmd, and 
  - RJwrapper.tex
  
under the paper folder. One last step before start on writing is to make a change on the bibliography reference in the Rmd YAML. By default, the template generates `bibliography: RJreferences.bib` in the YAML and you want to replace `RJreferences` with the file name you just specified: `cook-hurley-urbanek-kane` so that the `.bib` file can be found! 

# Check

In the `inst/paper` folder is an example article that has both html and pdf version rendered [manually put in RJournal.sty to render the pdf article] and we will be using it to demonstrate the check functions in the `rjtools`.

<!-- The properly rendered article should have `sample-article.tex` as the tex file, `RJwrapper.pdf` as the pdf document, `sample-article.R` that contains all the R codes in the Rmd file for reproducibility, and `sample-article.html` as the distill web article. -->


There are 9 functions in total for authors to check against and these checks can be performed in one go with `initial_check_article()` with the path to the article folder: 

```{r eval = FALSE}
initial_check_article(path = here::here("paper"))
```

An initial_check.log file will be created under the same directory to document the check results, as well as in the console. Check on each item is also supported by individual `check_*()` function: 

  - `check_wrappers()`
  - `check_filenames()`
  - `check_unnecessary_files()`
  - `check_cover_letter()`
  
  - `check_title()`
  - `check_section()`
  - `check_spelling()`
  - `check_proposed_pkg()`
  - `check_packages_availabl()`

Below we will check each item on the example article we create

## Wrappers

```{r}
check_wrappers(path = here::here("inst/paper"))
```

A properly rendered article should have both the `RJwrapper.tex` and `RJwrapper.pdf` file and our article passes this check. Good!

## Filenames

```{r}
check_filenames(path = here::here("inst/paper"))
```

As mentioned above, the .bib and .Rmd file should have consistent name when created. The .tex file with the same name is created when rendering the pdf article. Our article also passes this check :)

## Unnecessary files

```{r} 
check_unnecessary_files(path = here::here("inst/paper")) 
```

This function checks that the folder doesn't contain the `RJtemplate.tex` file, which is in the previous R journal template. The [authors instruction](https://journal.r-project.org/share/author-guide.pdf) requires the authors to replace the content of this `RJtemplate.tex` file with article content and name with the lowercase concatenated author name, so it is essentially the `.tex` file in the previous section. Our article don't have an issue here. Good :)

## Motivation letter

```{r} 
check_cover_letter(path = here::here("inst/paper")) 
```

Cover letter should be provided for article of type "add-on package" and saved at the same folder as the article. The function checks whether there is a file has the word "motivation" in its name and the note says our sample article has not yet a motivational letter. Bad!

## Article title

```{r} 
check_title(path = here::here("inst/paper")) 
```

The article title needs to be in the title case and we need to make this change before submission! Also if your title contains the package you're proposing, use the `\pkg{.}` tag rather than `\CRANpkg{.}`.

## Section title

```{r} 
check_section(path = here::here("inst/paper")) 
```

Section titles need to be in the sentence case and we have no problem here!

## Spelling

```{r} 
check_spelling(path = here::here("inst/paper")) 
```

The spell check is performed with the `hunspell` package and it uses the US spelling by default. British spelling can be checked with argument `dic = "en_GB"`. The R journal welcomes both the U.S and British spelling, along with other national variation, as long as consistency is maintained.

Spelling check is performed from the abstract to bibliography section, excluding the comments in the code chunks. Only words with all lowercase letters are checked to avoid picking up on acronyms and names. Notice that this is only a coarse check ...


## Proposed package

```{r eval = FALSE} 
check_proposed_pkg() 
```

The package proposed in an article should already be available on CRAN. `check_proposed_pkg` doesn't require any path file but will have the following prompt in the console:

  > What's the name of package being proposed in the article? If none, please enter 0. 

authors need to enter the exact package name for a cran download check with the `cranlogs` package.

## Package availability

```{r eval = FALSE} 
check_packages_available(path = here::here("inst/paper")) 
```


<!-- Notice that this is only an initial automated check and we recommend authors to also read [instructions for Authors](https://journal.r-project.org/share/author-guide.pdf) before submission. The initial check function documents the check results in a initial_checks.log file as well as in the console. A short description for each check function can be accessed via `help(checks, package = "rjtools")` and below are some additional information.  -->







